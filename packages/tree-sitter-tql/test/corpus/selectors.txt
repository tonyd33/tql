========================================
block
========================================

fn main() {
  class_declaration {
    class_body {
      method_definition {
      }
    }
  }
}

---

(source_file
  (function_definition
    (identifier)
    (selector
      (block_selector
        (node_type_selector
          (node_type))
        (selector
          (block_selector
            (node_type_selector
              (node_type))
            (selector
              (block_selector
                (node_type_selector
                  (node_type))))))))))

========================================
block chain
========================================

fn main() {
  class_declaration { } { class_body }
}

---

(source_file
  (function_definition
    (identifier)
    (selector
      (block_selector
        (block_selector
          (node_type_selector
            (node_type)))
        (selector
          (node_type_selector
            (node_type)))))))

========================================
field_name
========================================

fn main() {
  class_declaration {
    .decorator { }
  }

  class_declaration {
    .decorator.foo.bar { }
  }
}

---

(source_file
  (function_definition
    (identifier)
    (selector
      (block_selector
        (descendant_selector
          (block_selector
            (node_type_selector
              (node_type))
            (selector
              (block_selector
                (field_name_selector
                  (field_name)))))
          (node_type_selector
            (node_type)))
        (selector
          (block_selector
            (field_name_selector
              (field_name_selector
                (field_name_selector
                  (field_name))
                (field_name))
              (field_name))))))))

========================================
child
========================================

fn main() {
  class_declaration {
    .decorator > call_expression.identifier { }
  }
}

---

(source_file
  (function_definition
    (identifier)
    (selector
      (block_selector
        (node_type_selector
          (node_type))
        (selector
          (block_selector
            (field_name_selector
              (child_selector
                (field_name_selector
                  (field_name))
                (node_type_selector
                  (node_type)))
              (field_name))))))))

========================================
descendant
========================================

fn main() {
  class_declaration .decorator > call_expression .identifier {}
}

---

(source_file
  (function_definition
    (identifier)
    (selector
      (block_selector
        (descendant_selector
          (child_selector
            (descendant_selector
              (node_type_selector
                (node_type))
              (field_name_selector
                (field_name)))
            (node_type_selector
              (node_type)))
          (field_name_selector
            (field_name)))))))

========================================
function chain
========================================

fn main() {
  foo() bar();
  foo() > bar();
  foo().name;
  .decorator > foo() bar();
}

---

(source_file
  (function_definition
    (identifier)
    (selector
      (descendant_selector
        (function_invocation
          (identifier))
        (function_invocation
          (identifier))))
    (selector
      (child_selector
        (function_invocation
          (identifier))
        (function_invocation
          (identifier))))
    (selector
      (field_name_selector
        (function_invocation
          (identifier))
        (field_name)))
    (selector
      (descendant_selector
        (child_selector
          (field_name_selector
            (field_name))
          (function_invocation
            (identifier)))
        (function_invocation
          (identifier))))))

========================================
full example
========================================

fn main() {
  class_declaration {
    @class_name <- .name;
    @decorator_name <- .decorator > call_expression.function;
    @method <- .body > method_definition;

    text_eq(@decorator_name, 'Controller');
    !exists(@method.return_type);
  }
}

---

(source_file
  (function_definition
    (identifier)
    (selector
      (block_selector
        (node_type_selector
          (node_type))
        (assignment
          (explicit_assignment
            (variable_identifier
              (identifier))
            (selector
              (field_name_selector
                (field_name)))))
        (assignment
          (explicit_assignment
            (variable_identifier
              (identifier))
            (selector
              (field_name_selector
                (child_selector
                  (field_name_selector
                    (field_name))
                  (node_type_selector
                    (node_type)))
                (field_name)))))
        (assignment
          (explicit_assignment
            (variable_identifier
              (identifier))
            (selector
              (child_selector
                (field_name_selector
                  (field_name))
                (node_type_selector
                  (node_type))))))
        (selector
          (function_invocation
            (identifier)
            (selector
              (variable_identifier
                (identifier)))
            (string_literal
              (string_fragment))))
        (selector
          (negate_selector
            (function_invocation
              (identifier)
              (selector
                (field_name_selector
                  (variable_identifier
                    (identifier))
                  (field_name))))))))))
